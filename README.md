# rs-fMRI
Functional and Effective Connectivity Scripts - Appendix

FC.ipynb -  This script computes and visualizes functional connectivity (FC) matrices for merged default mode network (DMN) and basal forebrain (BF) regions in mice, based on denoised ROI time series data. The code loads all miceâ€™s time series from a JSON file, checks that ROI labeling is consistent, and then aggregates pre-defined anatomical groups by averaging the time series of their constituent ROIs. For each mouse, it calculates the correlation matrix (FC) across the merged regions. The resulting FC matrices are saved as NumPy arrays, and the average FC matrix across all mice is plotted as a heatmap, with regions labeled for easy interpretation. This process enables standardized, group-level connectivity analysis for targeted brain networks.

EFC.ipynb - This script analyzes and visualizes changes in effective connectivity within the default mode network (DMN) using Granger causality results from Pre-FUS and Post-FUS conditions. The code first loads a CSV file containing pairwise effective connectivity (GC) values between anatomical regions, clusters the regions into functionally meaningful DMN subnetworks (such as Prelimbic Cortex, Hippocampus, Retrosplenial Cortex, etc.), and computes average connectivity between clusters. It then saves the clustered data and creates a directed network graph that highlights connections with substantial changes after FUS stimulation. The graph uses edge colors to indicate increased (green) or decreased (red) causal influence from one DMN subnetwork to another, helping to visually summarize the directional network reorganization induced by neuromodulation.
